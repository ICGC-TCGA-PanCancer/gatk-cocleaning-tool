class: CommandLineTool
cwlVersion: v1.0
label: GATK Indel Realignment

hints:
  - class: ResourceRequirement
    coresMin: 8
    ramMin: 16

requirements:
  - class: DockerRequirement
    dockerPull: "opengenomics/gatk-cocleaning:v1.0"
  - class: ResourceRequirement
    coresMin: 16
    ramMin: 60

baseCommand: 
  - "python2.7"
  - "/opt/indel_realign.py"

arguments:
  - 
    valueFrom: "tumor_realigned.bam"
    prefix: -o
    position: 1
  - 
    valueFrom: "normal_realigned.bam"
    prefix: -o
    position: 2
  - 
    valueFrom: "12"
    prefix: --ncpus
    position: 3
  - 
    valueFrom: "60"
    prefix: --mem
    position: 4

inputs:
  tumor_bam:
    type: File
    inputBinding:
      prefix: -I
      position: 5

  tumor_bai:
    type: File

  normal_bam:
    type: File
    inputBinding:
      prefix: -I
      position: 6

  normal_bai:
    type: File

  reference:
    type: File
    inputBinding: 
      prefix: -R
      position: 7

  reference_fai:
    type: File

  reference_dict:
    type: File

  knownIndels:
    type: 
      - "null"
      - type: array
        items: File
        inputBinding:
          prefix: --known
    inputBinding:
      position: 8

  parallel_realign:
    type: ["null", boolean]
    inputBinding:
      prefix: --parallel-realign
      position: 9
      
outputs:
  tumor_realigned_bam:
    type: File
    outputBinding:
      glob: "tumor_realigned.bam"

  tumor_realigned_bai:
    type: File
    outputBinding:
      glob: "tumor_realigned.bam.bai"

  normal_realigned_bam:
    type: File
    outputBinding:
      glob: "normal_realigned.bam"

  normal_realigned_bai:
    type: File
    outputBinding:
      glob: "normal_realigned.bam.bai"
